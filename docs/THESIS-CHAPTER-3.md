# الفصل الثالث: تحليل المتطلبات
## نظام إدارة المقاولات

---

## 3.1 جمع المتطلبات

### 3.1.1 منهجية جمع المتطلبات

تم جمع متطلبات النظام من خلال:

1. **دراسة الحالة (Case Study)**
   - تحليل أنظمة إدارة المقاولات الموجودة
   - تحديد المشاكل والتحديات في الأنظمة الحالية
   - دراسة احتياجات المقاولين والعملاء

2. **المقابلات (Interviews)**
   - مقابلات مع مقاولين محليين
   - مقابلات مع عملاء
   - فهم العمليات الحالية

3. **الاستبيانات (Questionnaires)**
   - استبيان إلكتروني لتحديد الأولويات
   - جمع آراء المستخدمين المحتملين

4. **المراجعة الأدبية (Literature Review)**
   - مراجعة الأبحاث والدراسات السابقة
   - تحليل أفضل الممارسات في إدارة المشاريع

---

### 3.1.2 المشاكل المحددة

من خلال جمع المتطلبات، تم تحديد المشاكل التالية:

1. **عدم وجود نظام موحد**
   - استخدام طرق تقليدية (أوراق، Excel)
   - صعوبة تتبع المشاريع والمواد
   - عدم وجود تواصل فعال بين المقاول والعملاء

2. **إدارة المواد والمشتريات**
   - صعوبة تتبع المواد المستخدمة
   - عدم وجود نظام لإدارة الموردين
   - صعوبة حساب التكاليف بدقة

3. **إدارة المدفوعات**
   - عدم وجود نظام لتتبع المدفوعات
   - صعوبة إدارة الميزانية
   - عدم وجود تقارير مالية واضحة

4. **إدارة الطلبات**
   - صعوبة تتبع طلبات العملاء
   - عدم وجود نظام لموافقة/رفض الطلبات
   - صعوبة التواصل مع العملاء

---

## 3.2 المتطلبات الوظيفية (Functional Requirements)

### 3.2.1 إدارة المستخدمين (User Management)

#### FR-1: تسجيل الدخول والخروج
- **FR-1.1:** يجب أن يتمكن المستخدم من تسجيل الدخول باستخدام Google OAuth
- **FR-1.2:** يجب أن يتمكن المستخدم من تسجيل الخروج
- **FR-1.3:** يجب أن يتم حفظ حالة تسجيل الدخول (Session)
- **FR-1.4:** يجب أن يتم توجيه المستخدم حسب نوعه (عميل/مقاول)

#### FR-2: إدارة الحسابات
- **FR-2.1:** يجب أن يتمكن المقاول من إضافة عملاء جدد
- **FR-2.2:** يجب أن يتمكن المقاول من عرض قائمة العملاء
- **FR-2.3:** يجب أن يتمكن المقاول من تعديل بيانات العملاء
- **FR-2.4:** يجب أن يتمكن المقاول من حذف العملاء
- **FR-2.5:** يجب أن يتمكن المقاول من إضافة مقاولين آخرين
- **FR-2.6:** يجب أن يتم عرض معلومات المستخدم الحالي

---

### 3.2.2 إدارة المشاريع (Project Management)

#### FR-3: إنشاء وإدارة المشاريع
- **FR-3.1:** يجب أن يتمكن المقاول من إضافة مشروع جديد
- **FR-3.2:** يجب أن يتضمن المشروع:
  - اسم المشروع
  - الوصف
  - الموقع
  - الميزانية البدائية
  - العميل (اختياري)
  - تاريخ البدء
  - تاريخ الانتهاء المتوقع
  - الملاحظات

- **FR-3.3:** يجب أن يتمكن المقاول من عرض قائمة جميع المشاريع
- **FR-3.4:** يجب أن يتمكن المقاول من عرض تفاصيل مشروع معين
- **FR-3.5:** يجب أن يتمكن المقاول من تعديل بيانات المشروع
- **FR-3.6:** يجب أن يتمكن المقاول من حذف المشروع
- **FR-3.7:** يجب أن يتم تحديث حالة المشروع (pending, in-progress, completed, cancelled)
- **FR-3.8:** يجب أن يتم تحديث نسبة الإنجاز (Progress) للمشروع

#### FR-4: إدارة المواد في المشروع
- **FR-4.1:** يجب أن يتمكن المقاول من إضافة مواد للمشروع
- **FR-4.2:** يجب أن يتضمن كل مادة:
  - اسم المادة
  - الكمية
  - الوحدة
  - التكلفة

- **FR-4.3:** يجب أن يتمكن المقاول من عرض قائمة مواد المشروع
- **FR-4.4:** يجب أن يتمكن المقاول من تعديل بيانات المادة
- **FR-4.5:** يجب أن يتمكن المقاول من حذف المادة

#### FR-5: إدارة المهندسين في المشروع
- **FR-5.1:** يجب أن يتمكن المقاول من إضافة مهندسين للمشروع
- **FR-5.2:** يجب أن يتضمن كل مهندس:
  - الاسم
  - التخصص (مدني، عمارة، كهرباء)
  - الراتب
  - الهاتف
  - البريد الإلكتروني
  - الملاحظات

- **FR-5.3:** يجب أن يتمكن المقاول من عرض قائمة مهندسي المشروع
- **FR-5.4:** يجب أن يتمكن المقاول من حذف المهندس

#### FR-6: إدارة فرق العمل
- **FR-6.1:** يجب أن يتمكن المقاول من إضافة فرق عمل للمشروع
- **FR-6.2:** يجب أن يتمكن المقاول من عرض قائمة فرق العمل
- **FR-6.3:** يجب أن يتمكن المقاول من حذف فريق العمل

#### FR-7: إدارة صور المشروع
- **FR-7.1:** يجب أن يتمكن المقاول من رفع صور للمشروع
- **FR-7.2:** يجب أن يتمكن المقاول من عرض صور المشروع
- **FR-7.3:** يجب أن يتمكن المقاول من حذف الصور
- **FR-7.4:** يجب أن يتم ضغط الصور تلقائياً قبل الحفظ

---

### 3.2.3 إدارة الموردين (Suppliers Management)

#### FR-8: إدارة الموردين
- **FR-8.1:** يجب أن يتمكن المقاول من إضافة مورد جديد
- **FR-8.2:** يجب أن يتضمن كل مورد:
  - اسم المورد
  - الشخص المسؤول
  - الهاتف
  - البريد الإلكتروني
  - العنوان

- **FR-8.3:** يجب أن يتمكن المقاول من عرض قائمة الموردين
- **FR-8.4:** يجب أن يتمكن المقاول من تعديل بيانات المورد
- **FR-8.5:** يجب أن يتمكن المقاول من حذف المورد

---

### 3.2.4 إدارة المشتريات (Purchases Management)

#### FR-9: إدارة المشتريات
- **FR-9.1:** يجب أن يتمكن المقاول من إضافة عملية شراء جديدة
- **FR-9.2:** يجب أن تتضمن عملية الشراء:
  - المورد
  - المادة
  - الكمية
  - سعر الوحدة
  - السعر الإجمالي
  - تاريخ الشراء
  - الحالة (pending, completed, cancelled)
  - الملاحظات

- **FR-9.3:** يجب أن يتمكن المقاول من عرض قائمة المشتريات
- **FR-9.4:** يجب أن يتمكن المقاول من تعديل بيانات الشراء
- **FR-9.5:** يجب أن يتمكن المقاول من حذف الشراء
- **FR-9.6:** يجب أن يتم تحديث تكلفة المشروع تلقائياً عند إضافة شراء

---

### 3.2.5 إدارة المدفوعات (Payments Management)

#### FR-10: إدارة المدفوعات
- **FR-10.1:** يجب أن يتمكن المقاول من إضافة دفعة جديدة
- **FR-10.2:** يجب أن تتضمن الدفعة:
  - المشروع (اختياري)
  - المورد (اختياري)
  - المبلغ
  - تاريخ الدفع
  - طريقة الدفع (نقد، تحويل بنكي، شيك، بطاقة ائتمان)
  - الحالة (pending, completed, cancelled)
  - الملاحظات

- **FR-10.3:** يجب أن يتمكن المقاول من عرض قائمة المدفوعات
- **FR-10.4:** يجب أن يتمكن المقاول من تعديل بيانات الدفعة
- **FR-10.5:** يجب أن يتمكن المقاول من حذف الدفعة

---

### 3.2.6 إدارة الطلبات (Requests Management)

#### FR-11: إدارة طلبات العملاء
- **FR-11.1:** يجب أن يتمكن العميل من إضافة طلب جديد
- **FR-11.2:** يجب أن يتضمن الطلب:
  - العنوان
  - الوصف
  - الميزانية
  - الموقع
  - رقم الطلب (تلقائي)

- **FR-11.3:** يجب أن يتمكن المقاول من عرض قائمة طلبات العملاء
- **FR-11.4:** يجب أن يتمكن المقاول من قبول الطلب
- **FR-11.5:** يجب أن يتمكن المقاول من رفض الطلب
- **FR-11.6:** يجب أن يتم تحديث حالة الطلب تلقائياً

---

### 3.2.7 إدارة التقارير (Reports Management)

#### FR-12: إنشاء وعرض التقارير
- **FR-12.1:** يجب أن يتمكن المقاول من إنشاء تقرير جديد
- **FR-12.2:** يجب أن يتضمن التقرير:
  - المشروع (اختياري)
  - العنوان
  - النوع (مالي، تقدم، مواد، عام)
  - المحتوى
  - تاريخ التقرير

- **FR-12.3:** يجب أن يتمكن المقاول من عرض قائمة التقارير
- **FR-12.4:** يجب أن يتمكن المقاول من عرض تفاصيل التقرير
- **FR-12.5:** يجب أن يتمكن المقاول من تعديل التقرير
- **FR-12.6:** يجب أن يتمكن المقاول من حذف التقرير

---

### 3.2.8 إدارة العقود (Contracts Management)

#### FR-13: إدارة العقود
- **FR-13.1:** يجب أن يتمكن المقاول من إضافة عقد جديد
- **FR-13.2:** يجب أن يتضمن العقد:
  - المشروع
  - العميل
  - المقاول
  - رقم العقد
  - تاريخ العقد
  - تاريخ البدء
  - تاريخ الانتهاء
  - المبلغ الإجمالي
  - الحالة (draft, active, completed, cancelled)
  - الشروط

- **FR-13.3:** يجب أن يتمكن المقاول من عرض قائمة العقود
- **FR-13.4:** يجب أن يتمكن المقاول من تعديل العقد
- **FR-13.5:** يجب أن يتمكن المقاول من حذف العقد

---

## 3.3 المتطلبات غير الوظيفية (Non-Functional Requirements)

### 3.3.1 الأداء (Performance)

#### NFR-1: سرعة الاستجابة
- **NFR-1.1:** يجب أن تكون سرعة تحميل الصفحة الرئيسية أقل من 3 ثوانٍ
- **NFR-1.2:** يجب أن تكون سرعة استجابة API أقل من 500ms
- **NFR-1.3:** يجب أن تكون سرعة رفع الصور معقولة (مع الضغط)

#### NFR-2: قابلية التوسع (Scalability)
- **NFR-2.1:** يجب أن يدعم النظام 100 مستخدم متزامن على الأقل
- **NFR-2.2:** يجب أن يدعم النظام 1000 مشروع على الأقل
- **NFR-2.3:** يجب أن يكون النظام قابلاً للتوسع في المستقبل

---

### 3.3.2 الأمان (Security)

#### NFR-3: المصادقة والتفويض
- **NFR-3.1:** يجب أن يتم استخدام Google OAuth للمصادقة
- **NFR-3.2:** يجب أن يتم حماية جميع API endpoints
- **NFR-3.3:** يجب أن يتم التحقق من صلاحيات المستخدم قبل كل عملية

#### NFR-4: حماية البيانات
- **NFR-4.1:** يجب أن يتم تشفير كلمات المرور (إن وجدت)
- **NFR-4.2:** يجب أن يتم التحقق من صحة المدخلات (Input Validation)
- **NFR-4.3:** يجب أن يتم منع SQL Injection
- **NFR-4.4:** يجب أن يتم منع XSS (Cross-Site Scripting)

---

### 3.3.3 سهولة الاستخدام (Usability)

#### NFR-5: واجهة المستخدم
- **NFR-5.1:** يجب أن تكون الواجهة سهلة الاستخدام
- **NFR-5.2:** يجب أن تكون الواجهة متجاوبة (Responsive) للجوال والكمبيوتر
- **NFR-5.3:** يجب أن تكون الواجهة باللغة العربية
- **NFR-5.4:** يجب أن تكون الألوان والخطوط واضحة

#### NFR-6: تجربة المستخدم
- **NFR-6.1:** يجب أن تكون الرسائل واضحة ومفهومة
- **NFR-6.2:** يجب أن تكون رسائل الخطأ مفيدة
- **NFR-6.3:** يجب أن يكون هناك تأكيد قبل العمليات الحساسة (حذف، إلخ)

---

### 3.3.4 التوافقية (Compatibility)

#### NFR-7: المتصفحات
- **NFR-7.1:** يجب أن يعمل النظام على Chrome
- **NFR-7.2:** يجب أن يعمل النظام على Firefox
- **NFR-7.3:** يجب أن يعمل النظام على Edge
- **NFR-7.4:** يجب أن يعمل النظام على Safari

#### NFR-8: الأجهزة
- **NFR-8.1:** يجب أن يعمل النظام على أجهزة الكمبيوتر
- **NFR-8.2:** يجب أن يعمل النظام على الأجهزة اللوحية
- **NFR-8.3:** يجب أن يعمل النظام على الهواتف الذكية

---

### 3.3.5 الموثوقية (Reliability)

#### NFR-9: الاستقرار
- **NFR-9.1:** يجب أن يكون النظام متاحاً 99% من الوقت
- **NFR-9.2:** يجب أن يتم حفظ البيانات بشكل آمن
- **NFR-9.3:** يجب أن يتم عمل نسخ احتياطية (Backup) دورية

#### NFR-10: معالجة الأخطاء
- **NFR-10.1:** يجب أن يتم معالجة الأخطاء بشكل صحيح
- **NFR-10.2:** يجب أن يتم تسجيل الأخطاء (Logging)
- **NFR-10.3:** يجب أن يتم إعلام المستخدم بالأخطاء بشكل واضح

---

### 3.3.6 الصيانة (Maintainability)

#### NFR-11: الكود
- **NFR-11.1:** يجب أن يكون الكود منظم وواضح
- **NFR-11.2:** يجب أن يكون الكود موثق (Documented)
- **NFR-11.3:** يجب أن يكون الكود قابل لإعادة الاستخدام

---

## 3.4 نماذج الحالات الاستخدام (Use Cases)

### 3.4.1 Actors (الممثلون)

1. **المقاول (Contractor)**
   - المستخدم الرئيسي للنظام
   - لديه صلاحيات كاملة

2. **العميل (Client)**
   - يمكنه إضافة طلبات
   - يمكنه عرض مشاريعه

3. **النظام (System)**
   - يقوم بالعمليات التلقائية

---

### 3.4.2 Use Cases الرئيسية

#### UC-1: تسجيل الدخول
- **Actor:** المقاول/العميل
- **Precondition:** المستخدم لديه حساب Google
- **Main Flow:**
  1. المستخدم يفتح النظام
  2. النظام يعرض زر "تسجيل الدخول بـ Google"
  3. المستخدم ينقر على الزر
  4. يتم توجيه المستخدم إلى Google OAuth
  5. المستخدم يوافق على الصلاحيات
  6. يتم توجيه المستخدم إلى النظام
  7. يتم حفظ حالة تسجيل الدخول
  8. يتم توجيه المستخدم حسب نوعه

- **Postcondition:** المستخدم مسجل دخول

---

#### UC-2: إضافة مشروع جديد
- **Actor:** المقاول
- **Precondition:** المقاول مسجل دخول
- **Main Flow:**
  1. المقاول يذهب إلى صفحة "إضافة مشروع"
  2. المقاول يملأ البيانات الأساسية (الاسم، الموقع، الميزانية)
  3. المقاول يضيف المواد (اختياري)
  4. المقاول يضيف المهندسين (اختياري)
  5. المقاول يرفع الصور (اختياري)
  6. المقاول يضيف معلومات إضافية
  7. المقاول ينقر على "حفظ المشروع"
  8. النظام يحفظ المشروع
  9. النظام يعرض رسالة نجاح

- **Postcondition:** المشروع مضاف بنجاح

---

#### UC-3: إدارة المواد
- **Actor:** المقاول
- **Precondition:** المقاول مسجل دخول
- **Main Flow:**
  1. المقاول يفتح مشروع
  2. المقاول يذهب إلى تبويب "المواد"
  3. المقاول يضيف مادة جديدة (الاسم، الكمية، الوحدة، التكلفة)
  4. النظام يحفظ المادة
  5. المقاول يمكنه تعديل أو حذف المادة

- **Postcondition:** المواد محدثة

---

#### UC-4: قبول/رفض طلب عميل
- **Actor:** المقاول
- **Precondition:** المقاول مسجل دخول، يوجد طلبات جديدة
- **Main Flow:**
  1. المقاول يذهب إلى صفحة "طلبات العملاء"
  2. المقاول يعرض قائمة الطلبات
  3. المقاول يختار طلب
  4. المقاول يقرر قبول أو رفض الطلب
  5. النظام يحدث حالة الطلب
  6. النظام يعرض رسالة نجاح

- **Postcondition:** حالة الطلب محدثة

---

#### UC-5: إضافة مورد
- **Actor:** المقاول
- **Precondition:** المقاول مسجل دخول
- **Main Flow:**
  1. المقاول يذهب إلى صفحة "الموردين"
  2. المقاول ينقر على "إضافة مورد"
  3. المقاول يملأ البيانات (الاسم، الهاتف، البريد، العنوان)
  4. المقاول ينقر على "حفظ"
  5. النظام يحفظ المورد
  6. النظام يعرض رسالة نجاح

- **Postcondition:** المورد مضاف

---

#### UC-6: إضافة عملية شراء
- **Actor:** المقاول
- **Precondition:** المقاول مسجل دخول، يوجد موردين ومواد
- **Main Flow:**
  1. المقاول يذهب إلى صفحة "المشتريات"
  2. المقاول ينقر على "إضافة شراء"
  3. المقاول يختار المورد
  4. المقاول يختار المادة
  5. المقاول يدخل الكمية وسعر الوحدة
  6. النظام يحسب السعر الإجمالي تلقائياً
  7. المقاول ينقر على "حفظ"
  8. النظام يحفظ الشراء
  9. النظام يحدث تكلفة المشروع تلقائياً

- **Postcondition:** الشراء مضاف، تكلفة المشروع محدثة

---

#### UC-7: إنشاء تقرير
- **Actor:** المقاول
- **Precondition:** المقاول مسجل دخول
- **Main Flow:**
  1. المقاول يذهب إلى صفحة "التقارير"
  2. المقاول ينقر على "تقرير جديد"
  3. المقاول يختار النوع (مالي، تقدم، مواد، عام)
  4. المقاول يختار المشروع (اختياري)
  5. المقاول يكتب العنوان والمحتوى
  6. المقاول ينقر على "حفظ"
  7. النظام يحفظ التقرير
  8. النظام يعرض رسالة نجاح

- **Postcondition:** التقرير منشأ

---

### 3.4.3 Use Case Diagram

```
                    ┌─────────────┐
                    │   System    │
                    └─────────────┘
                           │
        ┌──────────────────┼──────────────────┐
        │                  │                  │
   ┌─────────┐      ┌──────────┐      ┌──────────┐
   │Contractor│      │  Client  │      │  System  │
   └─────────┘      └──────────┘      └──────────┘
        │                  │                  │
        │                  │                  │
   ┌────┴──────────────────┴──────────────────┴────┐
   │                                                 │
   │  UC-1: تسجيل الدخول                            │
   │  UC-2: إضافة مشروع                             │
   │  UC-3: إدارة المواد                            │
   │  UC-4: قبول/رفض طلب                            │
   │  UC-5: إضافة مورد                              │
   │  UC-6: إضافة شراء                              │
   │  UC-7: إنشاء تقرير                             │
   │                                                 │
   └─────────────────────────────────────────────────┘
```

---

## 3.5 ملخص المتطلبات

### 3.5.1 المتطلبات الوظيفية
- **13 مجموعة متطلبات وظيفية رئيسية**
- **60+ متطلب وظيفي تفصيلي**
- تغطي جميع جوانب النظام

### 3.5.2 المتطلبات غير الوظيفية
- **11 مجموعة متطلبات غير وظيفية**
- **30+ متطلب غير وظيفي**
- تغطي الأداء، الأمان، سهولة الاستخدام، التوافقية، الموثوقية، الصيانة

### 3.5.3 حالات الاستخدام
- **7 حالات استخدام رئيسية**
- **2 Actors رئيسيين** (المقاول، العميل)
- **1 Actor مساعد** (النظام)

---

## 3.6 الأولويات (Priorities)

### 3.6.1 متطلبات عالية الأولوية (Must Have)
- تسجيل الدخول
- إدارة المشاريع
- إدارة المواد
- إدارة الموردين
- إدارة الطلبات

### 3.6.2 متطلبات متوسطة الأولوية (Should Have)
- إدارة المدفوعات
- إدارة المشتريات
- إدارة التقارير
- إدارة العقود

### 3.6.3 متطلبات منخفضة الأولوية (Nice to Have)
- إدارة المهندسين
- إدارة فرق العمل
- إدارة الصور
- إشعارات متقدمة

---

**تم الإنشاء:** 2024
**آخر تحديث:** 2024

